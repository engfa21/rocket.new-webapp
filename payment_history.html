<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment History - StreamPay Pro</title>
    <link rel="stylesheet" href="main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fstreampay6097back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-primary-50 via-background to-accent-50">
    <!-- Navigation Header -->
    <nav class="bg-surface/80 backdrop-blur-md border-b border-border sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="user_dashboard.html" class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-text-primary">StreamPay Pro</span>
                    </a>
                </div>
                
                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="user_dashboard.html" class="text-text-secondary hover:text-primary transition-colors duration-200">Dashboard</a>
                    <a href="video_player.html" class="text-text-secondary hover:text-primary transition-colors duration-200">Videos</a>
                    <a href="payment_history.html" class="text-primary font-medium">Payment History</a>
                    <a href="admin_dashboard.html" class="text-text-secondary hover:text-primary transition-colors duration-200">Admin</a>
                </div>
                
                <!-- User Menu -->
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button id="user-menu-btn" class="flex items-center space-x-2 text-text-secondary hover:text-primary transition-colors duration-200">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="User Avatar" class="w-8 h-8 rounded-full object-cover" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                            <span class="hidden sm:block">John Doe</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>
                        
                        <!-- User Dropdown -->
                        <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-surface rounded-lg shadow-lg border border-border py-2">
                            <a href="user_dashboard.html" class="block px-4 py-2 text-sm text-text-secondary hover:bg-secondary-50 hover:text-primary transition-colors duration-200">Profile</a>
                            <a href="payment_history.html" class="block px-4 py-2 text-sm text-text-secondary hover:bg-secondary-50 hover:text-primary transition-colors duration-200">Payment History</a>
                            <div class="border-t border-border my-1"></div>
                            <a href="user_login.html" class="block px-4 py-2 text-sm text-text-secondary hover:bg-secondary-50 hover:text-primary transition-colors duration-200">Sign Out</a>
                        </div>
                    </div>
                    
                    <!-- Mobile Menu Button -->
                    <div class="md:hidden">
                        <button id="mobile-menu-btn" class="text-text-secondary hover:text-primary p-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-surface border-t border-border">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="user_dashboard.html" class="block px-3 py-2 text-text-secondary hover:text-primary hover:bg-secondary-50 rounded-md transition-colors duration-200">Dashboard</a>
                <a href="video_player.html" class="block px-3 py-2 text-text-secondary hover:text-primary hover:bg-secondary-50 rounded-md transition-colors duration-200">Videos</a>
                <a href="payment_history.html" class="block px-3 py-2 text-primary font-medium bg-primary-50 rounded-md">Payment History</a>
                <a href="admin_dashboard.html" class="block px-3 py-2 text-text-secondary hover:text-primary hover:bg-secondary-50 rounded-md transition-colors duration-200">Admin</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-fluid-3xl font-bold text-text-primary mb-2">Payment History</h1>
                    <p class="text-text-secondary">Track your transactions and download receipts</p>
                </div>
                <button id="export-btn" class="btn-secondary flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    <span>Export</span>
                </button>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Total Spending -->
            <div class="card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary mb-1">Total Spending</p>
                        <p class="text-2xl font-bold text-text-primary">$247.85</p>
                        <p class="text-sm text-success-600 flex items-center mt-1">
                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 14l5-5 5 5z"/>
                            </svg>
                            12% from last month
                        </p>
                    </div>
                    <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-primary" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary mb-1">Recent Transactions</p>
                        <p class="text-2xl font-bold text-text-primary">23</p>
                        <p class="text-sm text-text-secondary mt-1">Last 30 days</p>
                    </div>
                    <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Payment Methods -->
            <div class="card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary mb-1">Payment Methods</p>
                        <p class="text-2xl font-bold text-text-primary">3</p>
                        <p class="text-sm text-text-secondary mt-1">Cards & PayPal</p>
                    </div>
                    <div class="w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-success-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="card mb-6">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4">
                <!-- Search -->
                <div class="flex-1 max-w-md">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Search by video title or transaction ID..." class="input-field pl-10" />
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg class="w-5 h-5 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="flex flex-wrap items-center space-x-4">
                    <!-- Date Range -->
                    <select id="date-filter" class="input-field w-auto min-w-32">
                        <option value="all">All Time</option>
                        <option value="7">Last 7 days</option>
                        <option value="30">Last 30 days</option>
                        <option value="90">Last 3 months</option>
                        <option value="365">Last year</option>
                    </select>

                    <!-- Payment Method -->
                    <select id="method-filter" class="input-field w-auto min-w-32">
                        <option value="all">All Methods</option>
                        <option value="card">Credit Card</option>
                        <option value="paypal">PayPal</option>
                        <option value="crypto">Cryptocurrency</option>
                    </select>

                    <!-- Status -->
                    <select id="status-filter" class="input-field w-auto min-w-32">
                        <option value="all">All Status</option>
                        <option value="completed">Completed</option>
                        <option value="pending">Pending</option>
                        <option value="failed">Failed</option>
                    </select>

                    <!-- Reset Filters -->
                    <button id="reset-filters" class="btn-secondary">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Transaction Table -->
        <div class="card overflow-hidden">
            <!-- Desktop Table -->
            <div class="hidden lg:block overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-secondary-50 border-b border-border">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Transaction</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Video</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Amount</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Method</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Status</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="transactions-table" class="bg-surface divide-y divide-border">
                        <!-- Transaction rows will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Mobile Cards -->
            <div id="mobile-transactions" class="lg:hidden space-y-4">
                <!-- Transaction cards will be populated by JavaScript -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="hidden text-center py-12">
                <svg class="w-16 h-16 text-text-secondary mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <h3 class="text-lg font-medium text-text-primary mb-2">No transactions found</h3>
                <p class="text-text-secondary">Try adjusting your search or filter criteria</p>
            </div>

            <!-- Loading State -->
            <div id="loading-state" class="hidden text-center py-12">
                <div class="animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"></div>
                <p class="text-text-secondary">Loading transactions...</p>
            </div>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="flex items-center justify-between mt-6">
            <div class="text-sm text-text-secondary">
                Showing <span id="showing-from">1</span> to <span id="showing-to">10</span> of <span id="total-results">23</span> results
            </div>
            <div class="flex items-center space-x-2">
                <button id="prev-page" class="btn-secondary px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <div id="page-numbers" class="flex items-center space-x-1">
                    <!-- Page numbers will be populated by JavaScript -->
                </div>
                <button id="next-page" class="btn-secondary px-3 py-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </div>
    </main>

    <!-- Receipt Modal -->
    <div id="receipt-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-surface rounded-lg shadow-xl max-w-md w-full max-h-screen overflow-y-auto">
            <div class="p-6">
                <!-- Modal Header -->
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-text-primary">Transaction Receipt</h3>
                    <button id="close-modal" class="text-text-secondary hover:text-primary transition-colors duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>

                <!-- Receipt Content -->
                <div id="receipt-content" class="space-y-4">
                    <!-- Content will be populated by JavaScript -->
                </div>

                <!-- Modal Actions -->
                <div class="flex items-center justify-between mt-6 pt-4 border-t border-border">
                    <button id="download-receipt" class="btn-primary flex items-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <span>Download</span>
                    </button>
                    <button id="email-receipt" class="btn-secondary flex items-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        <span>Email</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-surface border-t border-border mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="text-center text-sm text-text-secondary">
                <p>&copy; 2025 StreamPay Pro. All Rights Reserved.</p>
                <div class="mt-2 space-x-4">
                    <a href="javascript:void(0)" class="hover:text-primary transition-colors duration-200">Privacy Policy</a>
                    <a href="javascript:void(0)" class="hover:text-primary transition-colors duration-200">Terms of Service</a>
                    <a href="javascript:void(0)" class="hover:text-primary transition-colors duration-200">Support</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Mock transaction data
        const mockTransactions = [
            {
                id: 'TXN-2025-001',
                date: '2025-01-05',
                videoTitle: 'Advanced JavaScript Masterclass',
                videoId: 'dQw4w9WgXcQ',
                amount: 29.99,
                method: 'Credit Card',
                methodIcon: 'card',
                status: 'completed',
                receiptNumber: 'RCP-2025-001',
                description: 'Premium video access purchase'
            },
            {
                id: 'TXN-2025-002',
                date: '2025-01-04',
                videoTitle: 'React Performance Optimization',
                videoId: 'jNQXAC9IVRw',
                amount: 24.99,
                method: 'PayPal',
                methodIcon: 'paypal',
                status: 'completed',
                receiptNumber: 'RCP-2025-002',
                description: 'Premium video access purchase'
            },
            {
                id: 'TXN-2025-003',
                date: '2025-01-03',
                videoTitle: 'Node.js Backend Development',
                videoId: 'M7lc1UVf-VE',
                amount: 34.99,
                method: 'Credit Card',
                methodIcon: 'card',
                status: 'pending',
                receiptNumber: 'RCP-2025-003',
                description: 'Premium video access purchase'
            },
            {
                id: 'TXN-2025-004',
                date: '2025-01-02',
                videoTitle: 'Python Data Science Bootcamp',
                videoId: 'kqtD5dpn9C8',
                amount: 39.99,
                method: 'Cryptocurrency',
                methodIcon: 'crypto',
                status: 'completed',
                receiptNumber: 'RCP-2025-004',
                description: 'Premium video access purchase'
            },
            {
                id: 'TXN-2025-005',
                date: '2025-01-01',
                videoTitle: 'Machine Learning Fundamentals',
                videoId: 'aircAruvnKk',
                amount: 44.99,
                method: 'PayPal',
                methodIcon: 'paypal',
                status: 'failed',
                receiptNumber: 'RCP-2025-005',
                description: 'Premium video access purchase'
            },
            {
                id: 'TXN-2024-023',
                date: '2024-12-30',
                videoTitle: 'Web Design Principles',
                videoId: 'YE7VzlLtp-4',
                amount: 19.99,
                method: 'Credit Card',
                methodIcon: 'card',
                status: 'completed',
                receiptNumber: 'RCP-2024-023',
                description: 'Premium video access purchase'
            }
        ];

        let filteredTransactions = [...mockTransactions];
        let currentPage = 1;
        const itemsPerPage = 10;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            renderTransactions();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Mobile menu toggle
            document.getElementById('mobile-menu-btn').addEventListener('click', function() {
                const mobileMenu = document.getElementById('mobile-menu');
                mobileMenu.classList.toggle('hidden');
            });

            // User menu toggle
            document.getElementById('user-menu-btn').addEventListener('click', function() {
                const dropdown = document.getElementById('user-dropdown');
                dropdown.classList.toggle('hidden');
            });

            // Close user menu when clicking outside
            document.addEventListener('click', function(e) {
                const userMenu = document.getElementById('user-menu-btn');
                const dropdown = document.getElementById('user-dropdown');
                if (!userMenu.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.add('hidden');
                }
            });

            // Search functionality
            document.getElementById('search-input').addEventListener('input', function() {
                filterTransactions();
            });

            // Filter functionality
            document.getElementById('date-filter').addEventListener('change', filterTransactions);
            document.getElementById('method-filter').addEventListener('change', filterTransactions);
            document.getElementById('status-filter').addEventListener('change', filterTransactions);

            // Reset filters
            document.getElementById('reset-filters').addEventListener('click', function() {
                document.getElementById('search-input').value = '';
                document.getElementById('date-filter').value = 'all';
                document.getElementById('method-filter').value = 'all';
                document.getElementById('status-filter').value = 'all';
                filterTransactions();
            });

            // Export functionality
            document.getElementById('export-btn').addEventListener('click', function() {
                exportTransactions();
            });

            // Modal functionality
            document.getElementById('close-modal').addEventListener('click', closeModal);
            document.getElementById('receipt-modal').addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });

            // Pagination
            document.getElementById('prev-page').addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    renderTransactions();
                }
            });

            document.getElementById('next-page').addEventListener('click', function() {
                const totalPages = Math.ceil(filteredTransactions.length / itemsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTransactions();
                }
            });
        }

        function filterTransactions() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const dateFilter = document.getElementById('date-filter').value;
            const methodFilter = document.getElementById('method-filter').value;
            const statusFilter = document.getElementById('status-filter').value;

            filteredTransactions = mockTransactions.filter(transaction => {
                // Search filter
                const matchesSearch = transaction.videoTitle.toLowerCase().includes(searchTerm) ||
                                    transaction.id.toLowerCase().includes(searchTerm);

                // Date filter
                let matchesDate = true;
                if (dateFilter !== 'all') {
                    const transactionDate = new Date(transaction.date);
                    const now = new Date();
                    const daysAgo = parseInt(dateFilter);
                    const cutoffDate = new Date(now.getTime() - (daysAgo * 24 * 60 * 60 * 1000));
                    matchesDate = transactionDate >= cutoffDate;
                }

                // Method filter
                const matchesMethod = methodFilter === 'all' || 
                                    transaction.methodIcon === methodFilter;

                // Status filter
                const matchesStatus = statusFilter === 'all' || 
                                    transaction.status === statusFilter;

                return matchesSearch && matchesDate && matchesMethod && matchesStatus;
            });

            currentPage = 1;
            renderTransactions();
        }

        function renderTransactions() {
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedTransactions = filteredTransactions.slice(startIndex, endIndex);

            // Render desktop table
            const tableBody = document.getElementById('transactions-table');
            tableBody.innerHTML = '';

            // Render mobile cards
            const mobileContainer = document.getElementById('mobile-transactions');
            mobileContainer.innerHTML = '';

            if (paginatedTransactions.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
                document.getElementById('pagination').classList.add('hidden');
                return;
            } else {
                document.getElementById('empty-state').classList.add('hidden');
                document.getElementById('pagination').classList.remove('hidden');
            }

            paginatedTransactions.forEach(transaction => {
                // Desktop table row
                const row = createTableRow(transaction);
                tableBody.appendChild(row);

                // Mobile card
                const card = createMobileCard(transaction);
                mobileContainer.appendChild(card);
            });

            updatePagination();
        }

        function createTableRow(transaction) {
            const row = document.createElement('tr');
            row.className = 'hover:bg-secondary-50 transition-colors duration-200';
            
            const statusColor = getStatusColor(transaction.status);
            const methodIcon = getMethodIcon(transaction.methodIcon);
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div>
                        <div class="text-sm font-medium text-text-primary">${transaction.id}</div>
                        <div class="text-sm text-text-secondary">${formatDate(transaction.date)}</div>
                    </div>
                </td>
                <td class="px-6 py-4">
                    <div class="text-sm font-medium text-text-primary">${transaction.videoTitle}</div>
                    <div class="text-sm text-text-secondary">${transaction.description}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-text-primary">$${transaction.amount.toFixed(2)}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                        ${methodIcon}
                        <span class="ml-2 text-sm text-text-primary">${transaction.method}</span>
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                        ${transaction.status.charAt(0).toUpperCase() + transaction.status.slice(1)}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button onclick="showReceipt('${transaction.id}')" class="text-primary hover:text-primary-700 mr-3 transition-colors duration-200">
                        View Receipt
                    </button>
                    <button onclick="watchVideo('${transaction.videoId}')" class="text-accent hover:text-accent-700 transition-colors duration-200">
                        Watch
                    </button>
                </td>
            `;
            
            return row;
        }

        function createMobileCard(transaction) {
            const card = document.createElement('div');
            card.className = 'bg-surface border border-border rounded-lg p-4';
            
            const statusColor = getStatusColor(transaction.status);
            const methodIcon = getMethodIcon(transaction.methodIcon);
            
            card.innerHTML = `
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <h3 class="text-sm font-medium text-text-primary mb-1">${transaction.videoTitle}</h3>
                        <p class="text-xs text-text-secondary">${transaction.id} • ${formatDate(transaction.date)}</p>
                    </div>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                        ${transaction.status.charAt(0).toUpperCase() + transaction.status.slice(1)}
                    </span>
                </div>
                
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center">
                        ${methodIcon}
                        <span class="ml-2 text-sm text-text-secondary">${transaction.method}</span>
                    </div>
                    <span class="text-lg font-semibold text-text-primary">$${transaction.amount.toFixed(2)}</span>
                </div>
                
                <div class="flex items-center justify-between pt-3 border-t border-border">
                    <button onclick="showReceipt('${transaction.id}')" class="text-sm text-primary hover:text-primary-700 transition-colors duration-200">
                        View Receipt
                    </button>
                    <button onclick="watchVideo('${transaction.videoId}')" class="text-sm text-accent hover:text-accent-700 transition-colors duration-200">
                        Watch Video
                    </button>
                </div>
            `;
            
            return card;
        }

        function getStatusColor(status) {
            switch (status) {
                case 'completed':
                    return 'bg-success-100 text-success-800';
                case 'pending':
                    return 'bg-warning-100 text-warning-800';
                case 'failed':
                    return 'bg-error-100 text-error-800';
                default:
                    return 'bg-secondary-100 text-secondary-800';
            }
        }

        function getMethodIcon(method) {
            switch (method) {
                case 'card':
                    return `<svg class="w-5 h-5 text-primary" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
                    </svg>`;
                case 'paypal':
                    return `<svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.69 1.81 1.01 1.15 1.304 2.42 1.012 4.287-.023.143-.047.288-.077.437-.983 5.05-4.349 6.797-8.647 6.797h-2.19c-.524 0-.968.382-1.05.9l-1.12 7.106zm14.146-14.42a3.35 3.35 0 0 0-.607-.541c-.013.076-.026.175-.041.26-.93 4.778-4.005 7.201-9.138 7.201h-2.19a.75.75 0 0 0-.741.63L7.25 21.621h3.224c.524 0 .968-.382 1.05-.9l.44-2.79c.082-.518.526-.9 1.05-.9h1.616c3.71 0 6.61-1.51 7.457-5.88.318-1.64.117-3.01-.865-4.05z"/>
                    </svg>`;
                case 'crypto':
                    return `<svg class="w-5 h-5 text-secondary-600" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1.5 4.5h3v2h-3v-2zm0 3h3v2h-3v-2zm0 3h3v2h-3v-2z"/>
                    </svg>`;
                default:
                    return `<svg class="w-5 h-5 text-text-secondary" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
                    </svg>`;
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function updatePagination() {
            const totalItems = filteredTransactions.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, totalItems);

            // Update showing text
            document.getElementById('showing-from').textContent = totalItems > 0 ? startIndex + 1 : 0;
            document.getElementById('showing-to').textContent = endIndex;
            document.getElementById('total-results').textContent = totalItems;

            // Update pagination buttons
            document.getElementById('prev-page').disabled = currentPage === 1;
            document.getElementById('next-page').disabled = currentPage === totalPages;

            // Update page numbers
            const pageNumbers = document.getElementById('page-numbers');
            pageNumbers.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    const button = document.createElement('button');
                    button.className = `px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200 ${
                        i === currentPage 
                            ? 'bg-primary text-white' 
                            : 'text-text-secondary hover:text-primary hover:bg-secondary-50'
                    }`;
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        currentPage = i;
                        renderTransactions();
                    });
                    pageNumbers.appendChild(button);
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'px-2 text-text-secondary';
                    ellipsis.textContent = '...';
                    pageNumbers.appendChild(ellipsis);
                }
            }
        }

        function showReceipt(transactionId) {
            const transaction = mockTransactions.find(t => t.id === transactionId);
            if (!transaction) return;

            const modal = document.getElementById('receipt-modal');
            const content = document.getElementById('receipt-content');
            
            content.innerHTML = `
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-gradient-primary rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </div>
                    <h4 class="text-lg font-semibold text-text-primary">StreamPay Pro</h4>
                    <p class="text-sm text-text-secondary">Payment Receipt</p>
                </div>
                
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Receipt Number:</span>
                        <span class="text-sm font-medium text-text-primary">${transaction.receiptNumber}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Transaction ID:</span>
                        <span class="text-sm font-medium text-text-primary">${transaction.id}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Date:</span>
                        <span class="text-sm font-medium text-text-primary">${formatDate(transaction.date)}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Video:</span>
                        <span class="text-sm font-medium text-text-primary">${transaction.videoTitle}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Payment Method:</span>
                        <span class="text-sm font-medium text-text-primary">${transaction.method}</span>
                    </div>
                    <div class="border-t border-border pt-3">
                        <div class="flex justify-between">
                            <span class="text-sm text-text-secondary">Amount:</span>
                            <span class="text-lg font-bold text-text-primary">$${transaction.amount.toFixed(2)}</span>
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-text-secondary">Status:</span>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(transaction.status)}">
                            ${transaction.status.charAt(0).toUpperCase() + transaction.status.slice(1)}
                        </span>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('receipt-modal').classList.add('hidden');
        }

        function watchVideo(videoId) {
            window.location.href = `video_player.html?v=${videoId}`;
        }

        function exportTransactions() {
            // Simulate export functionality
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Transaction ID,Date,Video Title,Amount,Payment Method,Status\n" +
                filteredTransactions.map(t => 
                    `${t.id},${t.date},"${t.videoTitle}",${t.amount},${t.method},${t.status}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "payment_history.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Download receipt functionality
        document.getElementById('download-receipt').addEventListener('click', function() {
            // Simulate download
            alert('Receipt downloaded successfully!');
        });

        // Email receipt functionality
        document.getElementById('email-receipt').addEventListener('click', function() {
            // Simulate email
            alert('Receipt sent to your email address!');
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>